#include "OOLC.h"

static void sceneReady(scene& scn, player& p);
static void sceneEnd(scene& scn);
void senlinfangjian(player& p) {
	scene senlinfangjian;
	sceneReady(senlinfangjian, p);
	senlinfangjian.gameStart();
    //动画
    try {
        while (1) {
            senlinfangjian.printMap();
 
            senlinfangjian.playerDo();//其他按键功能
            senlinfangjian.NPCDo();
            senlinfangjian.playerMove();
            senlinfangjian.NPCMove();
            senlinfangjian.esc();

            Sleep(50);
        }
    }
    catch (int) {//换地图，地图文件存档

    }
    catch (const char*) {//退出
        p.exit = 1;
    }
    sceneEnd(senlinfangjian);
}

static void sceneReady(scene& scn, player& p) {
	//玩家
    scn.p = &p;
    //地图
    scn.mp.High = 28, scn.mp.Long = 26;
    {
        Map& m = scn.mp;
            m[0][0] = 1, m[1][0] = 1, m[2][0] = 1, m[3][0] = 1, m[4][0] = 1, m[5][0] = 1, m[6][0] = 1, m[7][0] = 1, m[8][0] = 1, m[9][0] = 1, m[10][0] = 1, m[11][0] = 1, m[12][0] = 1, m[13][0] = 1, m[14][0] = 1, m[15][0] = 1, m[16][0] = 1, m[17][0] = 1, m[18][0] = 1, m[19][0] = 1, m[20][0] = 1, m[21][0] = 1, m[22][0] = 1, m[23][0] = 1, m[24][0] = 1, m[25][0] = 1;
        m[0][1] = 1, m[1][1] = 0, m[2][1] = 0, m[3][1] = 0, m[4][1] = 0, m[5][1] = 59, m[6][1] = 0, m[7][1] = 0, m[8][1] = 0, m[9][1] = 0, m[10][1] = 162, m[11][1] = 162, m[12][1] = 162, m[13][1] = 0, m[14][1] = 0, m[15][1] = 0, m[16][1] = 0, m[17][1] = 197, m[18][1] = 0, m[19][1] = 0, m[20][1] = 197, m[21][1] = 0, m[22][1] = 0, m[23][1] = 197, m[24][1] = 0, m[25][1] = 1;
        m[0][2] = 1, m[1][2] = 0, m[2][2] = 0, m[3][2] = 0, m[4][2] = 0, m[5][2] = 0, m[6][2] = 0, m[7][2] = 204, m[8][2] = 0, m[9][2] = 0, m[10][2] = 0, m[11][2] = 0, m[12][2] = 0, m[13][2] = 0, m[14][2] = 0, m[15][2] = 0, m[16][2] = 0, m[17][2] = 0, m[18][2] = 0, m[19][2] = 0, m[20][2] = 0, m[21][2] = 0, m[22][2] = 0, m[23][2] = 0, m[24][2] = 0, m[25][2] = 1;
        m[0][3] = 1, m[1][3] = 0, m[2][3] = 56, m[3][3] = 56, m[4][3] = 56, m[5][3] = 0, m[6][3] = 0, m[7][3] = 205, m[8][3] = 0, m[9][3] = 0, m[10][3] = 0, m[11][3] = 54, m[12][3] = 54, m[13][3] = 199, m[14][3] = 0, m[15][3] = 0, m[16][3] = 0, m[17][3] = 0, m[18][3] = 0, m[19][3] = 0, m[20][3] = 0, m[21][3] = 0, m[22][3] = 0, m[23][3] = 0, m[24][3] = 0, m[25][3] = 1;
        m[0][4] = 1, m[1][4] = 56, m[2][4] = 0, m[3][4] = 0, m[4][4] = 0, m[5][4] = 0, m[6][4] = 0, m[7][4] = 189, m[8][4] = 0, m[9][4] = 0, m[10][4] = 0, m[11][4] = 85, m[12][4] = 54, m[13][4] = 54, m[14][4] = 0, m[15][4] = 0, m[16][4] = 0, m[17][4] = 0, m[18][4] = 0, m[19][4] = 0, m[20][4] = 77, m[21][4] = 203, m[22][4] = 200, m[23][4] = 0, m[24][4] = 0, m[25][4] = 1;
        m[0][5] = 1, m[1][5] = 56, m[2][5] = 0, m[3][5] = 0, m[4][5] = 0, m[5][5] = 0, m[6][5] = 208, m[7][5] = 206, m[8][5] = 46, m[9][5] = 0, m[10][5] = 0, m[11][5] = 0, m[12][5] = 0, m[13][5] = 0, m[14][5] = 0, m[15][5] = 0, m[16][5] = 0, m[17][5] = 0, m[18][5] = 0, m[19][5] = 0, m[20][5] = 77, m[21][5] = 203, m[22][5] = 200, m[23][5] = 0, m[24][5] = 0, m[25][5] = 1;
        m[0][6] = 1, m[1][6] = 56, m[2][6] = 0, m[3][6] = 0, m[4][6] = 0, m[5][6] = 0, m[6][6] = 0, m[7][6] = 207, m[8][6] = 0, m[9][6] = 0, m[10][6] = 0, m[11][6] = 0, m[12][6] = 0, m[13][6] = 0, m[14][6] = 0, m[15][6] = 0, m[16][6] = 0, m[17][6] = 0, m[18][6] = 0, m[19][6] = 0, m[20][6] = 77, m[21][6] = 203, m[22][6] = 200, m[23][6] = 0, m[24][6] = 0, m[25][6] = 1;
        m[0][7] = 1, m[1][7] = 0, m[2][7] = 56, m[3][7] = 56, m[4][7] = 56, m[5][7] = 0, m[6][7] = 0, m[7][7] = 0, m[8][7] = 0, m[9][7] = 0, m[10][7] = 0, m[11][7] = 0, m[12][7] = 0, m[13][7] = 0, m[14][7] = 0, m[15][7] = 0, m[16][7] = 0, m[17][7] = 0, m[18][7] = 0, m[19][7] = 0, m[20][7] = 202, m[21][7] = 201, m[22][7] = 50, m[23][7] = 0, m[24][7] = 0, m[25][7] = 1;
        m[0][8] = 1, m[1][8] = 56, m[2][8] = 0, m[3][8] = 0, m[4][8] = 0, m[5][8] = 0, m[6][8] = 198, m[7][8] = 198, m[8][8] = 0, m[9][8] = 0, m[10][8] = 0, m[11][8] = 0, m[12][8] = 0, m[13][8] = 0, m[14][8] = 0, m[15][8] = 0, m[16][8] = 0, m[17][8] = 0, m[18][8] = 0, m[19][8] = 0, m[20][8] = 0, m[21][8] = 0, m[22][8] = 0, m[23][8] = 0, m[24][8] = 0, m[25][8] = 1;
        m[0][9] = 1, m[1][9] = 56, m[2][9] = 0, m[3][9] = 0, m[4][9] = 0, m[5][9] = 0, m[6][9] = 198, m[7][9] = 198, m[8][9] = 0, m[9][9] = 0, m[10][9] = 0, m[11][9] = 0, m[12][9] = 0, m[13][9] = 0, m[14][9] = 0, m[15][9] = 0, m[16][9] = 0, m[17][9] = 0, m[18][9] = 0, m[19][9] = 0, m[20][9] = 0, m[21][9] = 0, m[22][9] = 0, m[23][9] = 0, m[24][9] = 0, m[25][9] = 1;
        m[0][10] = 1, m[1][10] = 56, m[2][10] = 0, m[3][10] = 0, m[4][10] = 0, m[5][10] = 0, m[6][10] = 0, m[7][10] = 0, m[8][10] = 0, m[9][10] = 0, m[10][10] = 0, m[11][10] = 0, m[12][10] = 0, m[13][10] = 0, m[14][10] = 0, m[15][10] = 0, m[16][10] = 0, m[17][10] = 0, m[18][10] = 0, m[19][10] = 0, m[20][10] = 0, m[21][10] = 0, m[22][10] = 0, m[23][10] = 0, m[24][10] = 0, m[25][10] = 1;
        m[0][11] = 1, m[1][11] = 0, m[2][11] = 0, m[3][11] = 0, m[4][11] = 0, m[5][11] = 0, m[6][11] = 0, m[7][11] = 0, m[8][11] = 0, m[9][11] = 0, m[10][11] = 0, m[11][11] = 0, m[12][11] = 0, m[13][11] = 0, m[14][11] = 0, m[15][11] = 0, m[16][11] = 0, m[17][11] = 0, m[18][11] = 0, m[19][11] = 0, m[20][11] = 0, m[21][11] = 0, m[22][11] = 0, m[23][11] = 0, m[24][11] = 0, m[25][11] = 1;
        m[0][12] = 1, m[1][12] = 0, m[2][12] = 0, m[3][12] = 0, m[4][12] = 0, m[5][12] = 0, m[6][12] = 0, m[7][12] = 0, m[8][12] = 0, m[9][12] = 0, m[10][12] = 0, m[11][12] = 0, m[12][12] = 0, m[13][12] = 0, m[14][12] = 0, m[15][12] = 0, m[16][12] = 0, m[17][12] = 0, m[18][12] = 0, m[19][12] = 0, m[20][12] = 54, m[21][12] = 54, m[22][12] = 54, m[23][12] = 0, m[24][12] = 0, m[25][12] = 1;
        m[0][13] = 1, m[1][13] = 0, m[2][13] = 0, m[3][13] = 0, m[4][13] = 0, m[5][13] = 0, m[6][13] = 0, m[7][13] = 0, m[8][13] = 0, m[9][13] = 0, m[10][13] = 0, m[11][13] = 0, m[12][13] = 0, m[13][13] = 0, m[14][13] = 0, m[15][13] = 0, m[16][13] = 0, m[17][13] = 0, m[18][13] = 0, m[19][13] = 0, m[20][13] = 32, m[21][13] = 54, m[22][13] = 54, m[23][13] = 0, m[24][13] = 0, m[25][13] = 1;
        m[0][14] = 1, m[1][14] = 0, m[2][14] = 0, m[3][14] = 0, m[4][14] = 0, m[5][14] = 0, m[6][14] = 0, m[7][14] = 0, m[8][14] = 0, m[9][14] = 0, m[10][14] = 0, m[11][14] = 0, m[12][14] = 0, m[13][14] = 0, m[14][14] = 0, m[15][14] = 0, m[16][14] = 0, m[17][14] = 0, m[18][14] = 0, m[19][14] = 0, m[20][14] = 0, m[21][14] = 55, m[22][14] = 0, m[23][14] = 0, m[24][14] = 0, m[25][14] = 1;
        m[0][15] = 1, m[1][15] = 181, m[2][15] = 181, m[3][15] = 0, m[4][15] = 0, m[5][15] = 0, m[6][15] = 0, m[7][15] = 0, m[8][15] = 0, m[9][15] = 0, m[10][15] = 0, m[11][15] = 0, m[12][15] = 0, m[13][15] = 0, m[14][15] = 0, m[15][15] = 0, m[16][15] = 0, m[17][15] = 0, m[18][15] = 0, m[19][15] = 0, m[20][15] = 0, m[21][15] = 0, m[22][15] = 0, m[23][15] = 0, m[24][15] = 0, m[25][15] = 1;
        m[0][16] = 1, m[1][16] = 181, m[2][16] = 181, m[3][16] = 0, m[4][16] = 0, m[5][16] = 0, m[6][16] = 0, m[7][16] = 0, m[8][16] = 0, m[9][16] = 0, m[10][16] = 0, m[11][16] = 0, m[12][16] = 0, m[13][16] = 0, m[14][16] = 0, m[15][16] = 0, m[16][16] = 0, m[17][16] = 0, m[18][16] = 0, m[19][16] = 0, m[20][16] = 0, m[21][16] = 0, m[22][16] = 0, m[23][16] = 0, m[24][16] = 0, m[25][16] = 1;
        m[0][17] = 1, m[1][17] = 1, m[2][17] = 1, m[3][17] = 1, m[4][17] = 1, m[5][17] = 1, m[6][17] = 26, m[7][17] = 26, m[8][17] = 1, m[9][17] = 1, m[10][17] = 1, m[11][17] = 1, m[12][17] = 2, m[13][17] = 2, m[14][17] = 1, m[15][17] = 1, m[16][17] = 1, m[17][17] = 1, m[18][17] = 26, m[19][17] = 26, m[20][17] = 1, m[21][17] = 1, m[22][17] = 1, m[23][17] = 1, m[24][17] = 1, m[25][17] = 1;
        m[0][18] = 0, m[1][18] = 0, m[2][18] = 0, m[3][18] = 0, m[4][18] = 0, m[5][18] = 0, m[6][18] = 0, m[7][18] = 0, m[8][18] = 0, m[9][18] = 0, m[10][18] = 0, m[11][18] = 0, m[12][18] = 0, m[13][18] = 0, m[14][18] = 0, m[15][18] = 0, m[16][18] = 0, m[17][18] = 0, m[18][18] = 174, m[19][18] = 0, m[20][18] = 0, m[21][18] = 0, m[22][18] = 0, m[23][18] = 0, m[24][18] = 0, m[25][18] = 0;
        m[0][19] = 0, m[1][19] = 0, m[2][19] = 0, m[3][19] = 0, m[4][19] = 0, m[5][19] = 0, m[6][19] = 174, m[7][19] = 0, m[8][19] = 0, m[9][19] = 0, m[10][19] = 0, m[11][19] = 0, m[12][19] = 0, m[13][19] = 0, m[14][19] = 0, m[15][19] = 0, m[16][19] = 0, m[17][19] = 0, m[18][19] = 0, m[19][19] = 0, m[20][19] = 0, m[21][19] = 0, m[22][19] = 0, m[23][19] = 0, m[24][19] = 0, m[25][19] = 0;
        m[0][20] = 0, m[1][20] = 0, m[2][20] = 0, m[3][20] = 0, m[4][20] = 0, m[5][20] = 154, m[6][20] = 0, m[7][20] = 0, m[8][20] = 0, m[9][20] = 0, m[10][20] = 0, m[11][20] = 0, m[12][20] = 0, m[13][20] = 0, m[14][20] = 0, m[15][20] = 0, m[16][20] = 0, m[17][20] = 0, m[18][20] = 0, m[19][20] = 0, m[20][20] = 174, m[21][20] = 0, m[22][20] = 0, m[23][20] = 0, m[24][20] = 0, m[25][20] = 0;
        m[0][21] = 0, m[1][21] = 0, m[2][21] = 0, m[3][21] = 0, m[4][21] = 0, m[5][21] = 0, m[6][21] = 0, m[7][21] = 0, m[8][21] = 0, m[9][21] = 0, m[10][21] = 0, m[11][21] = 0, m[12][21] = 0, m[13][21] = 0, m[14][21] = 0, m[15][21] = 0, m[16][21] = 0, m[17][21] = 154, m[18][21] = 0, m[19][21] = 0, m[20][21] = 154, m[21][21] = 0, m[22][21] = 0, m[23][21] = 0, m[24][21] = 0, m[25][21] = 0;
        m[0][22] = 0, m[1][22] = 0, m[2][22] = 0, m[3][22] = 0, m[4][22] = 0, m[5][22] = 0, m[6][22] = 0, m[7][22] = 0, m[8][22] = 0, m[9][22] = 0, m[10][22] = 0, m[11][22] = 0, m[12][22] = 0, m[13][22] = 0, m[14][22] = 0, m[15][22] = 0, m[16][22] = 0, m[17][22] = 0, m[18][22] = 0, m[19][22] = 0, m[20][22] = 0, m[21][22] = 15, m[22][22] = 0, m[23][22] = 0, m[24][22] = 0, m[25][22] = 0;
        m[0][23] = 0, m[1][23] = 0, m[2][23] = 0, m[3][23] = 0, m[4][23] = 0, m[5][23] = 154, m[6][23] = 155, m[7][23] = 155, m[8][23] = 154, m[9][23] = 0, m[10][23] = 0, m[11][23] = 0, m[12][23] = 0, m[13][23] = 0, m[14][23] = 0, m[15][23] = 0, m[16][23] = 0, m[17][23] = 0, m[18][23] = 0, m[19][23] = 14, m[20][23] = 15, m[21][23] = 15, m[22][23] = 0, m[23][23] = 0, m[24][23] = 0, m[25][23] = 0;
        m[0][24] = 0, m[1][24] = 0, m[2][24] = 0, m[3][24] = 0, m[4][24] = 155, m[5][24] = 155, m[6][24] = 156, m[7][24] = 156, m[8][24] = 155, m[9][24] = 0, m[10][24] = 0, m[11][24] = 0, m[12][24] = 0, m[13][24] = 0, m[14][24] = 0, m[15][24] = 0, m[16][24] = 0, m[17][24] = 0, m[18][24] = 0, m[19][24] = 0, m[20][24] = 15, m[21][24] = 15, m[22][24] = 14, m[23][24] = 0, m[24][24] = 0, m[25][24] = 0;
        m[0][25] = 0, m[1][25] = 0, m[2][25] = 174, m[3][25] = 155, m[4][25] = 156, m[5][25] = 156, m[6][25] = 156, m[7][25] = 156, m[8][25] = 155, m[9][25] = 154, m[10][25] = 0, m[11][25] = 0, m[12][25] = 0, m[13][25] = 0, m[14][25] = 0, m[15][25] = 0, m[16][25] = 0, m[17][25] = 154, m[18][25] = 0, m[19][25] = 0, m[20][25] = 15, m[21][25] = 15, m[22][25] = 14, m[23][25] = 13, m[24][25] = 0, m[25][25] = 0;
        m[0][26] = 0, m[1][26] = 0, m[2][26] = 155, m[3][26] = 156, m[4][26] = 156, m[5][26] = 156, m[6][26] = 156, m[7][26] = 156, m[8][26] = 156, m[9][26] = 155, m[10][26] = 154, m[11][26] = 0, m[12][26] = 0, m[13][26] = 0, m[14][26] = 0, m[15][26] = 0, m[16][26] = 0, m[17][26] = 155, m[18][26] = 154, m[19][26] = 0, m[20][26] = 14, m[21][26] = 13, m[22][26] = 14, m[23][26] = 13, m[24][26] = 13, m[25][26] = 0;
        m[0][27] = 0, m[1][27] = 14, m[2][27] = 14, m[3][27] = 155, m[4][27] = 156, m[5][27] = 156, m[6][27] = 156, m[7][27] = 156, m[8][27] = 156, m[9][27] = 156, m[10][27] = 155, m[11][27] = 0, m[12][27] = 0, m[13][27] = 0, m[14][27] = 0, m[15][27] = 0, m[16][27] = 0, m[17][27] = 156, m[18][27] = 155, m[19][27] = 0, m[20][27] = 15, m[21][27] = 15, m[22][27] = 15, m[23][27] = 13, m[24][27] = 0, m[25][27] = 0;
    }

    {//地图传送門设置
           scn.NPCs.push_back(new door({ 12, 17 }, { 23, 39 }, 3));//森林
           scn.NPCs.push_back(new door({ 13, 17 }, { 24, 39 }, 3));

    }
}
static void sceneEnd(scene& scn) {
    while (!scn.NPCs.empty()) {
        delete scn.NPCs.back();
        scn.NPCs.pop_back();
    }
}